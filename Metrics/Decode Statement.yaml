description: Print out table vt_dim_statement, for reconciliation purposes.
version: 1
### ============= STANDARD PRE-PROCESSING =============
# SETUP run context, and skip duplicate CREATE vt_* statements :
{% set run = namespace(completed=[], dates=[]) if run is not defined else run %}
### import macro to harden start/end dates:
{% import "coa_util.j2" as macro with context %}
{{ macro.harden_dates(run, startdate, enddate) }}
{% set startdate = run.dates[0] %}
{% set enddate = run.dates[1] %}
### ============= STANDARD PRE-PROCESSING =============

tasks:

{% include "vt_decode_statement.j2" %}

- name: Export vt_decode_statement with all data
  connect: source
  export:
    file: decode_statement.csv
    sql: Select * from vt_decode_statement order by 2,1
